
DROP SCHEMA IF EXISTS "project" CASCADE;
CREATE SCHEMA "project";
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
----------------------------------------
----------------------------------------
----------------------------------------
----------------------------------------
----------------------------------------
----------------------------------------

DROP TABLE IF  EXISTS project.tb_line;
CREATE TABLE IF NOT EXISTS project.tb_line (
    code_id                  integer NOT NULL REFERENCES "meta"."code"(id)
    ,code                VARCHAR(10) NOT NULL REFERENCES "meta"."code"(code)
    , "price_type" integer not null REFERENCES "meta"."config"(id)
    , "x1" numeric
    , "y1" numeric
    , "x2" numeric
    , "y2" numeric
    , "x3" numeric
    , "y3" numeric
    , PRIMARY KEY(code_id,price_type)
);

----------------------------------------
----------------------------------------
----------------------------------------
----------------------------------------
----------------------------------------
DROP TABLE IF  EXISTS project.tb_monthly_peek;
CREATE TABLE IF NOT EXISTS project.tb_monthly_peek (
    code_id  integer NOT NULL REFERENCES "meta"."code"(id)
   ,"vol_dt"  numeric(6, 0)  NOT NULL REFERENCES "project"."tb_monthly_peek_volume"(dt)
   ,"is_peek" boolean
   ,"peek" numeric(2, 0) 
   ,"peek_range" numeric(2, 0)[]
   ,"peek_percent" numeric(10, 2) 
   ,"list" json
);

----------------------------------------
----------------------------------------
----------------------------------------
----------------------------------------
----------------------------------------

DROP TABLE IF  EXISTS project.tb_monthly_peek_volume CASCADE ;
CREATE TABLE IF NOT EXISTS project.tb_monthly_peek_volume  (
	"code_id" integer not null REFERENCES "meta"."code"(id),
   ,"dt" numeric(6, 0)  
   ,"dt_y" numeric(4, 0) not null REFERENCES "meta"."code"(id),
   ,"dt_m" numeric(2, 0)
   ,"vol" numeric(20, 0)
   , PRIMARY KEY(code_id, dt)
);
CREATE INDEX ON project.tb_monthly_peek_volume (dt);
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------

